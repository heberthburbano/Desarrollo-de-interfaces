<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trello Colaborativo</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-slate-100 min-h-screen flex flex-col overflow-hidden">

    <!-- Pantalla de autenticaci贸n -->
    <div id="auth-container" class="flex justify-center items-center min-h-screen p-5 bg-slate-50 absolute inset-0 z-50">
        <div class="auth-box bg-white p-10 rounded-2xl shadow-2xl w-full max-w-md">
            <div class="flex justify-center mb-6">
                <div class="p-3 bg-blue-100 rounded-full">
                    <i data-lucide="trello" class="w-10 h-10 text-blue-600"></i>
                </div>
            </div>
            <h1 class="text-center text-blue-600 mb-8 text-3xl font-bold"> Trello Colaborativo</h1>
            
            <div id="login-form">
                <h2 class="text-slate-800 mb-5 text-xl font-semibold">Iniciar Sesi贸n</h2>
                <input type="email" id="login-email" placeholder="Correo electr贸nico" 
                       class="w-full p-3 mb-4 border-2 border-slate-200 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
                <input type="password" id="login-password" placeholder="Contrase帽a" 
                       class="w-full p-3 mb-4 border-2 border-slate-200 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
                <button id="login-btn" class="w-full p-3 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg text-base font-bold cursor-pointer transition">
                    Iniciar Sesi贸n
                </button>
                <p class="text-center mt-4 text-slate-600">驴No tienes cuenta? <a href="#" id="show-register" class="text-blue-600 no-underline font-bold hover:underline">Reg铆strate</a></p>
            </div>
            
            <div id="register-form" style="display: none;">
                <h2 class="text-slate-800 mb-5 text-xl font-semibold">Registrarse</h2>
                <input type="text" id="register-name" placeholder="Nombre completo" 
                       class="w-full p-3 mb-4 border-2 border-slate-200 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
                <input type="email" id="register-email" placeholder="Correo electr贸nico" 
                       class="w-full p-3 mb-4 border-2 border-slate-200 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
                <input type="password" id="register-password" placeholder="Contrase帽a" 
                       class="w-full p-3 mb-4 border-2 border-slate-200 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
                <button id="register-btn" class="w-full p-3 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg text-base font-bold cursor-pointer transition">
                    Registrarse
                </button>
                <p class="text-center mt-4 text-slate-600">驴Ya tienes cuenta? <a href="#" id="show-login" class="text-blue-600 no-underline font-bold hover:underline">Inicia sesi贸n</a></p>
            </div>
            
            <div id="auth-error" class="error-message text-red-500 text-center mt-4 text-sm"></div>
        </div>
    </div>

    <!-- Aplicaci贸n principal -->
    <div id="app-container" class="hidden flex-1 flex flex-col">
        <header class="bg-white border-b border-slate-200 shadow-sm z-10 shrink-0">
            <div class="header-content max-w-screen-2xl mx-auto px-5 py-4 flex justify-between items-center">
                <div class="flex items-center gap-2">
                    <i data-lucide="trello" class="text-blue-600 w-7 h-7"></i>
                    <h1 class="text-blue-600 text-2xl font-bold tracking-tight"> Trello Colaborativo</h1>
                </div>
                <div class="user-info flex items-center gap-4">
                    <!-- Bot贸n de Notificaciones -->
                    <div class="relative">
                        <button id="notifications-btn" class="relative p-2 hover:bg-slate-100 rounded-lg transition">
                            <i data-lucide="bell" class="w-5 h-5 text-slate-600"></i>
                            <span id="notifications-badge" class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center font-bold">0</span>
                        </button>
                        <!-- Dropdown de Notificaciones -->
                        <div id="notifications-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-slate-200 max-h-96 overflow-y-auto z-50">
                            <div class="p-4 border-b border-slate-200 flex justify-between items-center">
                                <h3 class="font-bold text-slate-800">Notificaciones</h3>
                                <button id="mark-all-read-btn" class="text-xs text-blue-600 hover:underline">Marcar todas como le铆das</button>
                            </div>
                            <div id="notifications-list" class="divide-y divide-slate-100">
                                <p class="p-4 text-center text-slate-500 text-sm">No hay notificaciones</p>
                            </div>
                        </div>
                    </div>
                    
                    <span id="user-name" class="text-slate-700 font-medium hidden md:block"></span>
                    <button id="logout-btn" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white border-none rounded-lg cursor-pointer transition text-sm font-medium">
                        Cerrar Sesi贸n
                    </button>
                </div>
            </div>
        </header>

        <div class="boards-section flex-1 max-w-screen-2xl mx-auto px-5 py-8 overflow-y-auto">
            <div class="boards-header flex justify-between items-center mb-6">
                <h2 class="text-slate-800 text-3xl font-bold">Mis Tableros</h2>
                <button id="create-board-btn" class="btn-primary px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg cursor-pointer text-base font-bold transition shadow-sm flex items-center gap-2">
                    <i data-lucide="plus" class="w-4 h-4"></i> Nuevo Tablero
                </button>
            </div>
            <div id="boards-container" class="boards-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5"></div>
        </div>

        <div id="board-view" class="hidden flex-1 flex bg-blue-50 overflow-hidden">
            <!-- Contenedor principal con sidebar -->
            <div class="flex-1 flex flex-col overflow-hidden">
                <div class="board-header flex justify-between items-center mb-0 bg-white/70 backdrop-blur-sm px-5 py-4 border-b border-slate-200 shadow-sm">
                    <div class="flex items-center gap-3">
                        <button id="back-to-boards-btn" class="p-2 hover:bg-slate-200 rounded-lg text-slate-600 transition">
                            <i data-lucide="arrow-left" class="w-5 h-5"></i>
                        </button>
                        <h2 id="board-title" class="text-slate-800 text-2xl font-bold"></h2>
                        <!-- Badge de Rol del Usuario -->
                        <span id="user-role-badge" class="px-3 py-1 text-xs font-bold rounded-full"></span>
                    </div>
                    <div class="board-actions flex gap-3">
                        <button id="toggle-members-btn" class="px-4 py-2 bg-slate-500 hover:bg-slate-600 text-white border-none rounded-lg cursor-pointer text-sm font-bold transition flex items-center gap-2">
                            <i data-lucide="users" class="w-4 h-4"></i> Miembros
                        </button>
                        <button id="toggle-activity-btn" class="px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white border-none rounded-lg cursor-pointer text-sm font-bold transition flex items-center gap-2">
                            <i data-lucide="activity" class="w-4 h-4"></i> Actividad
                        </button>
                        <button id="add-list-btn" class="btn-primary px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg cursor-pointer text-sm font-bold transition flex items-center gap-2">
                            <i data-lucide="plus" class="w-4 h-4"></i> A帽adir Lista
                        </button>
                    </div>
                </div>
                <div id="lists-container" class="lists-container flex gap-5 overflow-x-auto p-5 flex-1"></div>
            </div>
            
            <!-- Panel Lateral de Miembros -->
            <div id="members-panel" class="hidden w-80 bg-white border-l border-slate-200 overflow-y-auto flex-shrink-0">
                <div class="p-5">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-slate-800 flex items-center gap-2">
                            <i data-lucide="users" class="w-5 h-5"></i> Miembros
                        </h3>
                        <button id="close-members-btn" class="text-slate-400 hover:text-slate-600">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                    
                    <button id="invite-member-btn" class="w-full mb-4 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition flex items-center justify-center gap-2">
                        <i data-lucide="user-plus" class="w-4 h-4"></i> Invitar Miembro
                    </button>
                    
                    <div id="members-list" class="space-y-3">
                        <!-- Lista de miembros se carga din谩micamente -->
                    </div>
                </div>
            </div>
            
            <!-- Panel Lateral de Actividad -->
            <div id="activity-panel" class="hidden w-80 bg-white border-l border-slate-200 overflow-y-auto flex-shrink-0">
                <div class="p-5">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg text-slate-800 flex items-center gap-2">
                            <i data-lucide="activity" class="w-5 h-5"></i> Actividad
                        </h3>
                        <button id="close-activity-btn" class="text-slate-400 hover:text-slate-600">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                    
                    <div id="activity-list" class="space-y-3">
                        <!-- Actividad se carga din谩micamente -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para crear tablero -->
    <div id="board-modal" class="modal hidden fixed inset-0 bg-black/50 z-[1000] flex justify-center items-center">
        <div class="modal-content bg-white p-8 rounded-xl shadow-2xl w-11/12 max-w-md">
            <h3 class="text-slate-800 mb-5 text-xl font-bold">Crear Nuevo Tablero</h3>
            <input type="text" id="board-name-input" placeholder="Nombre del tablero" 
                   class="w-full p-3 mb-4 border-2 border-slate-300 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
            <div class="modal-actions flex gap-3 justify-end mt-5">
                <button id="cancel-board-btn" class="btn-secondary px-5 py-2.5 bg-slate-400 hover:bg-slate-500 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Cancelar
                </button>
                <button id="save-board-btn" class="btn-primary px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Crear
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para invitar miembro -->
    <div id="invite-modal" class="modal hidden fixed inset-0 bg-black/50 z-[1000] flex justify-center items-center">
        <div class="modal-content bg-white p-8 rounded-xl shadow-2xl w-11/12 max-w-md">
            <h3 class="text-slate-800 mb-5 text-xl font-bold">Invitar Colaborador</h3>
            <input type="email" id="invite-email-input" placeholder="correo@ejemplo.com" 
                   class="w-full p-3 mb-4 border-2 border-slate-300 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-slate-700 mb-2">Rol:</label>
                <div class="space-y-2">
                    <label class="flex items-center p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition">
                        <input type="radio" name="invite-role" value="editor" checked class="mr-3">
                        <div>
                            <div class="font-medium text-slate-800">Editor</div>
                            <div class="text-xs text-slate-500">Puede crear y editar tarjetas</div>
                        </div>
                    </label>
                    <label class="flex items-center p-3 border-2 border-slate-200 rounded-lg cursor-pointer hover:bg-slate-50 transition">
                        <input type="radio" name="invite-role" value="viewer" class="mr-3">
                        <div>
                            <div class="font-medium text-slate-800">Observador</div>
                            <div class="text-xs text-slate-500">Solo puede ver y comentar</div>
                        </div>
                    </label>
                </div>
            </div>
            
            <div class="modal-actions flex gap-3 justify-end mt-5">
                <button id="cancel-invite-btn" class="btn-secondary px-5 py-2.5 bg-slate-400 hover:bg-slate-500 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Cancelar
                </button>
                <button id="send-invite-btn" class="btn-primary px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Enviar Invitaci贸n
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para crear lista -->
    <div id="list-modal" class="modal hidden fixed inset-0 bg-black/50 z-[1000] flex justify-center items-center">
        <div class="modal-content bg-white p-8 rounded-xl shadow-2xl w-11/12 max-w-md">
            <h3 class="text-slate-800 mb-5 text-xl font-bold">Crear Nueva Lista</h3>
            <input type="text" id="list-name-input" placeholder="Nombre de la lista" 
                   class="w-full p-3 mb-4 border-2 border-slate-300 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
            <div class="modal-actions flex gap-3 justify-end mt-5">
                <button id="cancel-list-btn" class="btn-secondary px-5 py-2.5 bg-slate-400 hover:bg-slate-500 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Cancelar
                </button>
                <button id="save-list-btn" class="btn-primary px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Crear
                </button>
            </div>
        </div>
    </div>

    <!-- Modal para crear/editar tarjeta -->
    <div id="card-modal" class="modal hidden fixed inset-0 bg-black/50 z-[1000] flex justify-center items-center">
        <div class="modal-content card-modal-content bg-white p-8 rounded-xl shadow-2xl w-11/12 max-w-2xl">
            <h3 id="card-modal-title" class="text-slate-800 mb-5 text-xl font-bold">Nueva Tarjeta</h3>
            <input type="text" id="card-title-input" placeholder="T铆tulo de la tarjeta" 
                   class="w-full p-3 mb-4 border-2 border-slate-300 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
            <textarea id="card-description-input" placeholder="Descripci贸n (opcional)" 
                      class="w-full p-3 mb-4 border-2 border-slate-300 rounded-lg text-base min-h-[100px] resize-y focus:outline-none focus:border-blue-500 transition"></textarea>
            <input type="text" id="card-assigned-input" placeholder="Asignar a (opcional)" 
                   class="w-full p-3 mb-4 border-2 border-slate-300 rounded-lg text-base focus:outline-none focus:border-blue-500 transition">
            
            <div id="card-comments-section" style="display: none;" class="mt-5 pt-5 border-t-2 border-slate-200">
                <h4 class="text-slate-800 mb-4 font-semibold">Comentarios</h4>
                <div id="comments-list" class="max-h-[200px] overflow-y-auto mb-4"></div>
                <textarea id="comment-input" placeholder="A帽adir comentario..." 
                          class="w-full p-3 mb-3 border-2 border-slate-300 rounded-lg text-sm resize-none focus:outline-none focus:border-blue-500 transition"></textarea>
                <button id="add-comment-btn" class="btn-secondary px-4 py-2 bg-slate-500 hover:bg-slate-600 text-white border-none rounded-lg cursor-pointer text-sm font-medium transition">
                    Comentar
                </button>
            </div>
            
            <div class="modal-actions flex gap-3 justify-end mt-5">
                <button id="delete-card-btn" class="btn-danger px-5 py-2.5 bg-red-500 hover:bg-red-600 text-white border-none rounded-lg cursor-pointer text-base font-bold transition" style="display: none;">
                    Eliminar
                </button>
                <button id="cancel-card-btn" class="btn-secondary px-5 py-2.5 bg-slate-400 hover:bg-slate-500 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Cancelar
                </button>
                <button id="save-card-btn" class="btn-primary px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white border-none rounded-lg cursor-pointer text-base font-bold transition">
                    Guardar
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts de Firebase v9 Modular SDK -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="auth.js"></script>
    <script type="module" src="app.js"></script>
    
    <!-- Inicializar iconos Lucide -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });
    </script>
</body>
</html>
